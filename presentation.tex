% Renato Bellotti, October 2018

\documentclass{beamer}

\usepackage{tikz}
%\usepackage{enumitem}
\usepackage{tcolorbox}
\usepackage{amsmath}

\setbeamertemplate{navigation symbols}{}

\input{images/helpers.tex}

\begin{document}

\begin{frame}{Multi-GPU accelerated multi-spin Monte Carlo simulations of the 2D Ising model}
\begin{tabular}{c c c}
    \input{images/spin_lattice.tex}
    \textbf{\huge{+}} &
    \includegraphics[keepaspectratio=true, width=0.2\paperwidth]{images/multi_gpu.png}
    \textbf{\huge{=}} &
    \includegraphics[keepaspectratio=true, width=0.2\paperwidth]{images/cheetah.jpg}
\end{tabular}
\end{frame}

\setcounter{framenumber}{0}
\setbeamertemplate{navigation symbols}{\insertframenumber}

\begin{frame}{What was done?}
    \begin{itemize}
        \item \textbf{Ising model}
            \noindent \ising
        \item \textbf{Metropolis algorithm:}\\
            Efficient sampling
            \begin{equation*}
                p_a = e^{-\frac{E}{k_B T}}
            \end{equation*}
    \end{itemize} \pause
    \vspace{5mm}
    \begin{minipage}{0.2\paperwidth}
        Single core CPU\\
        \includegraphics[keepaspectratio=true, height=2cm]{images/intel_xeon.jpg}
    \end{minipage} \pause
    \hfill
    \begin{minipage}{0.2\paperwidth}
        Single GPU\\
        \includegraphics[keepaspectratio=true, height=2cm]{images/gpu_modified.png}
    \end{minipage} \pause
    \hfill
    \begin{minipage}{0.3\paperwidth}
        Mutliple GPUs\\
        \includegraphics[keepaspectratio=true, height=2cm]{images/multi_gpu.png}
    \end{minipage} \pause
\noindent\begin{mybox}
    How does it scale? Is it worth the effort?
\end{mybox}
\end{frame}

\begin{frame}{Ising model I}
\begin{itemize}
    \item Formula:
        \ising \pause
    \item A standard model of statistical physics \pause
    \item classical model \pause
    \item Describes magnets:\\
        \begin{minipage}{0.3\paperwidth}\input{images/spin_lattice.tex}\end{minipage}
        \begin{minipage}[c]{0.2\paperwidth} $\mathrel{\widehat{=}}$ \end{minipage}
        \begin{minipage}{0.2\paperwidth}\includegraphics[keepaspectratio=true, width=0.3\paperwidth]{images/magnet.jpg}\end{minipage} \pause
    \item System sizes: $100'000 \times 100'000$
\end{itemize}
\end{frame}

\begin{frame}{Ising model II}
    Nearest neighbour interactions only!
    \ising \pause
    \vspace{1cm}
    \begin{minipage}{0.3\paperwidth}\input{images/spin_lattice_all_interactions.tex}\end{minipage}
    {\Huge$\Rightarrow$}
    \begin{minipage}{0.2\paperwidth}\input{images/spin_lattice_nn.tex}\end{minipage} \pause
    
    Calculation of energy: $\mathcal{O}\left( n^2 \right) \Rightarrow \mathcal{O}\left( n \right)$
\end{frame}

\begin{frame}{Metropolis algorithm}
\begin{itemize}
    \item \textbf{Goal:} Sample phase space\\
        \vspace{3mm}
        \begin{minipage}[c]{0.4\textwidth}
            \input{images/spin_lattice.tex}
        \end{minipage}
        \begin{minipage}[c]{0.2\textwidth} {\Huge $\stackrel{!}{\sim}$} \end{minipage}
        \begin{minipage}[c]{0.3\textwidth} {\Huge $e^{-\frac{E}{k_B T}}$} \end{minipage} \pause
    \vspace{2mm}
    \item \textbf{Algorithm:}\\ \pause
            1.) Propose new state: Random spin flips!\\
            \vspace{2mm}
            \begin{minipage}{0.3\textwidth}
                \input{images/flip_before.tex}
            \end{minipage}
            \hfill
            \begin{minipage}[c]{0.2\textwidth} {\Huge $\Rightarrow$} \end{minipage}
            \begin{minipage}[c]{0.3\textwidth}
                \input{images/flip_after.tex}
            \end{minipage}\\ \pause
            2.) Accept the new configuration: $p_a = e^{-\frac{\Delta E}{k_B T}}$
\end{itemize}
\end{frame}

\begin{frame}{Single core CPU implementation}
\begin{itemize}
    \item Multi-spin coding: 1~spin $\mathrel{\widehat{=}}$ 1~bit \pause
    \item Group spins in groups of size 32 (int)
    \item 100'000 $\times$ 100'000 lattice: $\approx$~1.2~GB
\end{itemize}
\end{frame}

\end{document}
